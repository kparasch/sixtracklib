#ifndef SIXTRACKLIB_COMMON_BE_TRICUB_COEFFICIENTS_C99_H__
#define SIXTRACKLIB_COMMON_BE_TRICUB_COEFFICIENTS_C99_H__

/*
#if !defined(SIXTRL_NO_SYSTEM_INCLUDES)
    #include <stddef.h>
    #include <math.h>
#endif */
/* !defined(SIXTRL_NO_SYSTEM_INCLUDES) */

#if !defined(SIXTRL_NO_INCLUDES)
    #include "sixtracklib/common/definitions.h"
    #include "sixtracklib/common/be_tricub/be_tricub.h"
#endif /* !defined(SIXTRL_NO_INCLUDES) */

#if !defined( _GPUCODE ) && defined( __cplusplus )
extern "C" {
#endif /* !defined( _GPUCODE ) && defined( __cplusplus ) */

SIXTRL_STATIC SIXTRL_FN void NS(tricub_unscaled_kicks_from_b1)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks);

SIXTRL_STATIC SIXTRL_FN void NS(tricub_unscaled_kicks_from_b2)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks);

SIXTRL_STATIC SIXTRL_FN void NS(tricub_unscaled_kicks_from_b3)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks);

SIXTRL_STATIC SIXTRL_FN void NS(tricub_unscaled_kicks_from_b4)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks);

SIXTRL_STATIC SIXTRL_FN void NS(tricub_unscaled_kicks_from_b5)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks);

SIXTRL_STATIC SIXTRL_FN void NS(tricub_unscaled_kicks_from_b6)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks);

SIXTRL_STATIC SIXTRL_FN void NS(tricub_unscaled_kicks_from_b7)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks);

SIXTRL_STATIC SIXTRL_FN void NS(tricub_unscaled_kicks_from_b8)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks);

#if !defined( _GPUCODE ) && defined( __cplusplus )
}
#endif /* !defined( _GPUCODE ) && defined( __cplusplus ) */

/* ************************************************************************* */
/* ************************************************************************* */

#if !defined( _GPUCODE ) && defined( __cplusplus )
extern "C" {
#endif /* !defined( _GPUCODE ) && defined( __cplusplus ) */

SIXTRL_INLINE void NS(tricub_unscaled_kicks_from_b1)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks
    )
{
//    NS(be_tricub_real_t) const tri_consts[9] = {2.0, 3.0, 4.0, 6.0, 8.0, 9.0, 12.0, 18.0, 27.0};
    NS(be_tricub_real_t) coef;
    NS(be_tricub_real_t) akick;

    NS(be_tricub_real_t) const x2 = x1*x1;
    NS(be_tricub_real_t) const y2 = y1*y1;
    NS(be_tricub_real_t) const z2 = z1*z1;

    NS(be_tricub_real_t) const x3 = x2*x1;
    NS(be_tricub_real_t) const y3 = y2*y1;
    NS(be_tricub_real_t) const z3 = z2*z1;

    coef = b[0];
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    akick = coef * z1;
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[4]; coef -= b[4]; 
    akick = coef * z2;
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    akick = coef * y1;
    kicks[1] += akick; kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    akick = coef * (y1 * z2);
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y2 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    akick = coef * (y1 * z3);
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y2 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[2]; coef -= b[2]; 
    akick = coef * y2;
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    akick = coef * (y2 * z2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y3 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    akick = coef * (y2 * z3);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y3 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    akick = coef * x1;
    kicks[0] += akick; kicks[0] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    akick = coef * (x1 * z2);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    akick = coef * (x1 * z3);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    akick = coef * (x1 * y2);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * y1);
    kicks[1] += akick; kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    akick = coef * (x1 * y3);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * y2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; 
    akick = coef * x2;
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    akick = coef * (x2 * z2);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    akick = coef * (x2 * z3);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    akick = coef * (x2 * y2);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * y1);
    kicks[1] += akick; kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    akick = coef * (x2 * y3);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * y2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 

    return;
}

SIXTRL_INLINE void NS(tricub_unscaled_kicks_from_b2)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks
    )
{
//    NS(be_tricub_real_t) const tri_consts[9] = {2.0, 3.0, 4.0, 6.0, 8.0, 9.0, 12.0, 18.0, 27.0};
    NS(be_tricub_real_t) coef;
    NS(be_tricub_real_t) akick;

    NS(be_tricub_real_t) const x2 = x1*x1;
    NS(be_tricub_real_t) const y2 = y1*y1;
    NS(be_tricub_real_t) const z2 = z1*z1;

    NS(be_tricub_real_t) const x3 = x2*x1;
    NS(be_tricub_real_t) const y3 = y2*y1;
    NS(be_tricub_real_t) const z3 = z2*z1;

    coef = b[0];
    akick = coef;
    kicks[0] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    akick = coef * z2;
    kicks[0] += akick; 
    akick = coef * (x1 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[4]; coef -= b[4]; 
    akick = coef * z3;
    kicks[0] += akick; 
    akick = coef * (x1 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    akick = coef * y2;
    kicks[0] += akick; 
    akick = coef * (x1 * y1);
    kicks[1] += akick; kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    akick = coef * (y2 * z2);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    akick = coef * (y2 * z3);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[2]; coef -= b[2]; 
    akick = coef * y3;
    kicks[0] += akick; 
    akick = coef * (x1 * y2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    akick = coef * (y3 * z2);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    akick = coef * (y3 * z3);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1];
    akick = coef * x1;
    kicks[0] += akick; kicks[0] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    akick = coef * (x1 * z2);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; 
    akick = coef * (x1 * z3);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    akick = coef * (x1 * y2);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * y1);
    kicks[1] += akick; kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; 
    akick = coef * (x1 * y3);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * y2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[1];
    akick = coef * x2;
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; 
    akick = coef * (x2 * z2);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; 
    coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; 
    akick = coef * (x2 * z3);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; 
    akick = coef * (x2 * y2);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * y1);
    kicks[1] += akick; kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; 
    akick = coef * (x2 * y3);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * y2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 

    return;
}

SIXTRL_INLINE void NS(tricub_unscaled_kicks_from_b3)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks
    )
{
//    NS(be_tricub_real_t) const tri_consts[9] = {2.0, 3.0, 4.0, 6.0, 8.0, 9.0, 12.0, 18.0, 27.0};
    NS(be_tricub_real_t) coef;
    NS(be_tricub_real_t) akick;

    NS(be_tricub_real_t) const x2 = x1*x1;
    NS(be_tricub_real_t) const y2 = y1*y1;
    NS(be_tricub_real_t) const z2 = z1*z1;

    NS(be_tricub_real_t) const x3 = x2*x1;
    NS(be_tricub_real_t) const y3 = y2*y1;
    NS(be_tricub_real_t) const z3 = z2*z1;

    coef = b[0];
    akick = coef;
    kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    akick = coef * z2;
    kicks[1] += akick; 
    akick = coef * (y1 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[4]; coef -= b[4]; 
    akick = coef * z3;
    kicks[1] += akick; 
    akick = coef * (y1 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[2];
    akick = coef * y1;
    kicks[1] += akick; kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    akick = coef * (y1 * z2);
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y2 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[2]; coef -= b[2]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[6]; coef += b[6]; 
    akick = coef * (y1 * z3);
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y2 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[2];
    akick = coef * y2;
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[6]; coef += b[6]; coef += b[6]; 
    akick = coef * (y2 * z2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y3 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef += b[2]; coef += b[2]; 
    coef -= b[4]; coef -= b[4]; 
    coef -= b[6]; coef -= b[6]; 
    akick = coef * (y2 * z3);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y3 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    akick = coef * (x1 * y1);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * x2;
    kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    akick = coef * ( (x1 * y1) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z2);
    kicks[1] += akick; 
    akick = coef * ( (x2 * y1) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    akick = coef * ( (x1 * y1) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z3);
    kicks[1] += akick; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    akick = coef * (x1 * y2);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * y1);
    kicks[1] += akick; kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; 
    akick = coef * (x1 * y3);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * y2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; 
    akick = coef * (x2 * y1);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * x3;
    kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z2);
    kicks[1] += akick; 
    akick = coef * ( (x3 * y1) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    akick = coef * ( (x2 * y1) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z3);
    kicks[1] += akick; 
    akick = coef * ( (x3 * y1) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; 
    akick = coef * (x2 * y2);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * y1);
    kicks[1] += akick; kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; 
    akick = coef * (x2 * y3);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * y2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 

    return;
}

SIXTRL_INLINE void NS(tricub_unscaled_kicks_from_b4)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks
    )
{
//    NS(be_tricub_real_t) const tri_consts[9] = {2.0, 3.0, 4.0, 6.0, 8.0, 9.0, 12.0, 18.0, 27.0};
    NS(be_tricub_real_t) coef;
    NS(be_tricub_real_t) akick;

    NS(be_tricub_real_t) const x2 = x1*x1;
    NS(be_tricub_real_t) const y2 = y1*y1;
    NS(be_tricub_real_t) const z2 = z1*z1;

    NS(be_tricub_real_t) const x3 = x2*x1;
    NS(be_tricub_real_t) const y3 = y2*y1;
    NS(be_tricub_real_t) const z3 = z2*z1;

    coef = b[0];
    akick = coef;
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[4];
    akick = coef * z1;
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[4];
    akick = coef * z2;
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    akick = coef * (y1 * z1);
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * y2;
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    akick = coef * (y1 * z2);
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y2 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[6]; coef += b[6]; coef += b[6]; 
    akick = coef * (y1 * z3);
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y2 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[2]; coef -= b[2]; 
    akick = coef * (y2 * z1);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * y3;
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[4]; coef -= b[4]; 
    coef += b[6]; coef += b[6]; 
    akick = coef * (y2 * z2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y3 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[2]; coef -= b[2]; 
    coef += b[4]; coef += b[4]; 
    coef -= b[6]; coef -= b[6]; 
    akick = coef * (y2 * z3);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y3 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    akick = coef * (x1 * z1);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * x2;
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    akick = coef * (x1 * z2);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; 
    akick = coef * (x1 * z3);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    akick = coef * ( (x1 * y2) * z1 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z1 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x2 * y2);
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    akick = coef * ( (x1 * y3) * z1 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x2 * y3);
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; 
    akick = coef * (x2 * z1);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * x3;
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; 
    akick = coef * (x2 * z2);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; 
    akick = coef * (x2 * z3);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z1 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x3 * y2);
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    akick = coef * ( (x2 * y3) * z1 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z1 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x3 * y3);
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 

    return;
}

SIXTRL_INLINE void NS(tricub_unscaled_kicks_from_b5)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks
    )
{
//    NS(be_tricub_real_t) const tri_consts[9] = {2.0, 3.0, 4.0, 6.0, 8.0, 9.0, 12.0, 18.0, 27.0};
    NS(be_tricub_real_t) coef;
    NS(be_tricub_real_t) akick;

    NS(be_tricub_real_t) const x2 = x1*x1;
    NS(be_tricub_real_t) const y2 = y1*y1;
    NS(be_tricub_real_t) const z2 = z1*z1;

    NS(be_tricub_real_t) const x3 = x2*x1;
    NS(be_tricub_real_t) const y3 = y2*y1;
    NS(be_tricub_real_t) const z3 = z2*z1;

    coef = b[0];
    akick = coef * y1;
    kicks[0] += akick; 
    akick = coef * x1;
    kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    akick = coef * (y1 * z2);
    kicks[0] += akick; 
    akick = coef * (x1 * z2);
    kicks[1] += akick; 
    akick = coef * ( (x1 * y1) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[4]; coef -= b[4]; 
    akick = coef * (y1 * z3);
    kicks[0] += akick; 
    akick = coef * (x1 * z3);
    kicks[1] += akick; 
    akick = coef * ( (x1 * y1) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[2];
    akick = coef * y2;
    kicks[0] += akick; 
    akick = coef * (x1 * y1);
    kicks[1] += akick; kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    akick = coef * (y2 * z2);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[2]; coef -= b[2]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[6]; coef += b[6]; 
    akick = coef * (y2 * z3);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[2];
    akick = coef * y3;
    kicks[0] += akick; 
    akick = coef * (x1 * y2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[6]; coef += b[6]; coef += b[6]; 
    akick = coef * (y3 * z2);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef += b[2]; coef += b[2]; 
    coef -= b[4]; coef -= b[4]; 
    coef -= b[6]; coef -= b[6]; 
    akick = coef * (y3 * z3);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1];
    akick = coef * (x1 * y1);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * x2;
    kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    akick = coef * ( (x1 * y1) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z2);
    kicks[1] += akick; 
    akick = coef * ( (x2 * y1) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; 
    akick = coef * ( (x1 * y1) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z3);
    kicks[1] += akick; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; 
    coef += b[3];
    akick = coef * (x1 * y2);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * y1);
    kicks[1] += akick; kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1];
    coef -= b[2]; coef -= b[2]; 
    coef -= b[3];
    akick = coef * (x1 * y3);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * y2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[1];
    akick = coef * (x2 * y1);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * x3;
    kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z2);
    kicks[1] += akick; 
    akick = coef * ( (x3 * y1) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; 
    coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; 
    akick = coef * ( (x2 * y1) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z3);
    kicks[1] += akick; 
    akick = coef * ( (x3 * y1) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef -= b[2];
    coef -= b[3];
    akick = coef * (x2 * y2);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * y1);
    kicks[1] += akick; kicks[1] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef += b[6]; coef += b[6]; 
    coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[1];
    coef += b[2];
    coef += b[3];
    akick = coef * (x2 * y3);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * y2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; 
    coef -= b[6]; coef -= b[6]; 
    coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 

    return;
}

SIXTRL_INLINE void NS(tricub_unscaled_kicks_from_b6)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks
    )
{
//    NS(be_tricub_real_t) const tri_consts[9] = {2.0, 3.0, 4.0, 6.0, 8.0, 9.0, 12.0, 18.0, 27.0};
    NS(be_tricub_real_t) coef;
    NS(be_tricub_real_t) akick;

    NS(be_tricub_real_t) const x2 = x1*x1;
    NS(be_tricub_real_t) const y2 = y1*y1;
    NS(be_tricub_real_t) const z2 = z1*z1;

    NS(be_tricub_real_t) const x3 = x2*x1;
    NS(be_tricub_real_t) const y3 = y2*y1;
    NS(be_tricub_real_t) const z3 = z2*z1;

    coef = b[0];
    akick = coef * z1;
    kicks[0] += akick; 
    akick = coef * x1;
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[4];
    akick = coef * z2;
    kicks[0] += akick; 
    akick = coef * (x1 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[4];
    akick = coef * z3;
    kicks[0] += akick; 
    akick = coef * (x1 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    akick = coef * (y2 * z1);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y1) * z1 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x1 * y2);
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    akick = coef * (y2 * z2);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[6]; coef += b[6]; coef += b[6]; 
    akick = coef * (y2 * z3);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[2]; coef -= b[2]; 
    akick = coef * (y3 * z1);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y2) * z1 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x1 * y3);
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[4]; coef -= b[4]; 
    coef += b[6]; coef += b[6]; 
    akick = coef * (y3 * z2);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[2]; coef -= b[2]; 
    coef += b[4]; coef += b[4]; 
    coef -= b[6]; coef -= b[6]; 
    akick = coef * (y3 * z3);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1];
    akick = coef * (x1 * z1);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * x2;
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; 
    coef += b[4]; coef += b[4]; 
    coef += b[5];
    akick = coef * (x1 * z2);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1];
    coef -= b[4]; coef -= b[4]; 
    coef -= b[5];
    akick = coef * (x1 * z3);
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    akick = coef * ( (x1 * y2) * z1 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z1 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x2 * y2);
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; 
    akick = coef * ( (x1 * y3) * z1 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x2 * y3);
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; coef += b[6]; 
    coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[1];
    akick = coef * (x2 * z1);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * x3;
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef -= b[4];
    coef -= b[5];
    akick = coef * (x2 * z2);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[1];
    coef += b[4];
    coef += b[5];
    akick = coef * (x2 * z3);
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z1 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x3 * y2);
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; 
    akick = coef * ( (x2 * y3) * z1 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z1 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x3 * y3);
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; 
    coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; 
    coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 

    return;
}

SIXTRL_INLINE void NS(tricub_unscaled_kicks_from_b7)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks
    )
{
//    NS(be_tricub_real_t) const tri_consts[9] = {2.0, 3.0, 4.0, 6.0, 8.0, 9.0, 12.0, 18.0, 27.0};
    NS(be_tricub_real_t) coef;
    NS(be_tricub_real_t) akick;

    NS(be_tricub_real_t) const x2 = x1*x1;
    NS(be_tricub_real_t) const y2 = y1*y1;
    NS(be_tricub_real_t) const z2 = z1*z1;

    NS(be_tricub_real_t) const x3 = x2*x1;
    NS(be_tricub_real_t) const y3 = y2*y1;
    NS(be_tricub_real_t) const z3 = z2*z1;

    coef = b[0];
    akick = coef * z1;
    kicks[1] += akick; 
    akick = coef * y1;
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[4];
    akick = coef * z2;
    kicks[1] += akick; 
    akick = coef * (y1 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[4];
    akick = coef * z3;
    kicks[1] += akick; 
    akick = coef * (y1 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[2];
    akick = coef * (y1 * z1);
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * y2;
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[2]; coef += b[2]; 
    coef += b[4]; coef += b[4]; 
    coef += b[6];
    akick = coef * (y1 * z2);
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y2 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[2];
    coef -= b[4]; coef -= b[4]; 
    coef -= b[6];
    akick = coef * (y1 * z3);
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y2 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[2];
    akick = coef * (y2 * z1);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * y3;
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[2]; coef -= b[2]; 
    coef -= b[4];
    coef -= b[6];
    akick = coef * (y2 * z2);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y3 * z1);
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[2];
    coef += b[4];
    coef += b[6];
    akick = coef * (y2 * z3);
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (y3 * z2);
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    akick = coef * ( (x1 * y1) * z1 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z1);
    kicks[1] += akick; 
    akick = coef * (x2 * y1);
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    akick = coef * ( (x1 * y1) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z2);
    kicks[1] += akick; 
    akick = coef * ( (x2 * y1) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; 
    akick = coef * ( (x1 * y1) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z3);
    kicks[1] += akick; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    akick = coef * ( (x1 * y2) * z1 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z1 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x2 * y2);
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; 
    akick = coef * ( (x1 * y3) * z1 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x2 * y3);
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x1 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; coef += b[7]; 
    akick = coef * ( (x1 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; 
    akick = coef * ( (x2 * y1) * z1 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z1);
    kicks[1] += akick; 
    akick = coef * (x3 * y1);
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z2);
    kicks[1] += akick; 
    akick = coef * ( (x3 * y1) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; 
    akick = coef * ( (x2 * y1) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z3);
    kicks[1] += akick; 
    akick = coef * ( (x3 * y1) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z1 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x3 * y2);
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; 
    akick = coef * ( (x2 * y3) * z1 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z1 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x3 * y3);
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef += b[3]; coef += b[3]; coef += b[3]; coef += b[3]; 
    coef -= b[4]; coef -= b[4]; 
    coef += b[5]; coef += b[5]; 
    coef -= b[6]; coef -= b[6]; 
    coef += b[7]; coef += b[7]; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef += b[2]; coef += b[2]; 
    coef -= b[3]; coef -= b[3]; 
    coef += b[4]; coef += b[4]; 
    coef -= b[5]; coef -= b[5]; 
    coef += b[6]; coef += b[6]; 
    coef -= b[7]; coef -= b[7]; 
    akick = coef * ( (x2 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 

    return;
}

SIXTRL_INLINE void NS(tricub_unscaled_kicks_from_b8)(
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t) const* SIXTRL_RESTRICT b,
    NS(be_tricub_real_t) x1,
    NS(be_tricub_real_t) y1,
    NS(be_tricub_real_t) z1,
    SIXTRL_ARGPTR_DEC NS(be_tricub_real_t)* kicks
    )
{
//    NS(be_tricub_real_t) const tri_consts[9] = {2.0, 3.0, 4.0, 6.0, 8.0, 9.0, 12.0, 18.0, 27.0};
    NS(be_tricub_real_t) coef;
    NS(be_tricub_real_t) akick;

    NS(be_tricub_real_t) const x2 = x1*x1;
    NS(be_tricub_real_t) const y2 = y1*y1;
    NS(be_tricub_real_t) const z2 = z1*z1;

    NS(be_tricub_real_t) const x3 = x2*x1;
    NS(be_tricub_real_t) const y3 = y2*y1;
    NS(be_tricub_real_t) const z3 = z2*z1;

    coef = b[0];
    akick = coef * (y1 * z1);
    kicks[0] += akick; 
    akick = coef * (x1 * z1);
    kicks[1] += akick; 
    akick = coef * (x1 * y1);
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[4];
    akick = coef * (y1 * z2);
    kicks[0] += akick; 
    akick = coef * (x1 * z2);
    kicks[1] += akick; 
    akick = coef * ( (x1 * y1) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[4];
    akick = coef * (y1 * z3);
    kicks[0] += akick; 
    akick = coef * (x1 * z3);
    kicks[1] += akick; 
    akick = coef * ( (x1 * y1) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[2];
    akick = coef * (y2 * z1);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y1) * z1 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x1 * y2);
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[2]; coef += b[2]; 
    coef += b[4]; coef += b[4]; 
    coef += b[6];
    akick = coef * (y2 * z2);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[2];
    coef -= b[4]; coef -= b[4]; 
    coef -= b[6];
    akick = coef * (y2 * z3);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[2];
    akick = coef * (y3 * z1);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y2) * z1 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x1 * y3);
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[2]; coef -= b[2]; 
    coef -= b[4];
    coef -= b[6];
    akick = coef * (y3 * z2);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[2];
    coef += b[4];
    coef += b[6];
    akick = coef * (y3 * z3);
    kicks[0] += akick; 
    akick = coef * ( (x1 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x1 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1];
    akick = coef * ( (x1 * y1) * z1 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z1);
    kicks[1] += akick; 
    akick = coef * (x2 * y1);
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; 
    coef += b[4]; coef += b[4]; 
    coef += b[5];
    akick = coef * ( (x1 * y1) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z2);
    kicks[1] += akick; 
    akick = coef * ( (x2 * y1) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1];
    coef -= b[4]; coef -= b[4]; 
    coef -= b[5];
    akick = coef * ( (x1 * y1) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x2 * z3);
    kicks[1] += akick; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; 
    coef += b[3];
    akick = coef * ( (x1 * y2) * z1 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z1 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x2 * y2);
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; 
    coef -= b[4]; coef -= b[4]; coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; 
    coef -= b[6]; coef -= b[6]; 
    coef -= b[7];
    akick = coef * ( (x1 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; 
    coef += b[3];
    coef += b[4]; coef += b[4]; coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; 
    coef += b[6]; coef += b[6]; 
    coef += b[7];
    akick = coef * ( (x1 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1];
    coef -= b[2]; coef -= b[2]; 
    coef -= b[3];
    akick = coef * ( (x1 * y3) * z1 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z1 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x2 * y3);
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; 
    coef += b[5];
    coef += b[6]; coef += b[6]; 
    coef += b[7];
    akick = coef * ( (x1 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1];
    coef -= b[2]; coef -= b[2]; 
    coef -= b[3];
    coef -= b[4]; coef -= b[4]; 
    coef -= b[5];
    coef -= b[6]; coef -= b[6]; 
    coef -= b[7];
    akick = coef * ( (x1 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x2 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x2 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[1];
    akick = coef * ( (x2 * y1) * z1 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z1);
    kicks[1] += akick; 
    akick = coef * (x3 * y1);
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef -= b[4];
    coef -= b[5];
    akick = coef * ( (x2 * y1) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z2);
    kicks[1] += akick; 
    akick = coef * ( (x3 * y1) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[1];
    coef += b[4];
    coef += b[5];
    akick = coef * ( (x2 * y1) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * (x3 * z3);
    kicks[1] += akick; 
    akick = coef * ( (x3 * y1) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef -= b[2];
    coef -= b[3];
    akick = coef * ( (x2 * y2) * z1 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z1 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x3 * y2);
    kicks[2] += akick; 
    coef = b[0]; coef += b[0]; coef += b[0]; coef += b[0]; 
    coef += b[1]; coef += b[1]; coef += b[1]; coef += b[1]; 
    coef += b[2]; coef += b[2]; 
    coef += b[3]; coef += b[3]; 
    coef += b[4]; coef += b[4]; 
    coef += b[5]; coef += b[5]; 
    coef += b[6];
    coef += b[7];
    akick = coef * ( (x2 * y2) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z2 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef -= b[2];
    coef -= b[3];
    coef -= b[4]; coef -= b[4]; 
    coef -= b[5]; coef -= b[5]; 
    coef -= b[6];
    coef -= b[7];
    akick = coef * ( (x2 * y2) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y1) * z3 );
    kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[1];
    coef += b[2];
    coef += b[3];
    akick = coef * ( (x2 * y3) * z1 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z1 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * (x3 * y3);
    kicks[2] += akick; 
    coef = -b[0]; coef -= b[0]; 
    coef -= b[1]; coef -= b[1]; 
    coef -= b[2]; coef -= b[2]; 
    coef -= b[3]; coef -= b[3]; 
    coef -= b[4];
    coef -= b[5];
    coef -= b[6];
    coef -= b[7];
    akick = coef * ( (x2 * y3) * z2 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z2 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z1 );
    kicks[2] += akick; kicks[2] += akick; 
    coef = b[0];
    coef += b[1];
    coef += b[2];
    coef += b[3];
    coef += b[4];
    coef += b[5];
    coef += b[6];
    coef += b[7];
    akick = coef * ( (x2 * y3) * z3 );
    kicks[0] += akick; kicks[0] += akick; kicks[0] += akick; 
    akick = coef * ( (x3 * y2) * z3 );
    kicks[1] += akick; kicks[1] += akick; kicks[1] += akick; 
    akick = coef * ( (x3 * y3) * z2 );
    kicks[2] += akick; kicks[2] += akick; kicks[2] += akick; 

    return;
}


#if !defined( _GPUCODE ) && defined( __cplusplus )
}
#endif /* !defined( _GPUCODE ) && defined( __cplusplus ) */

#endif /* SIXTRACKLIB_COMMON_BE_TRICUB_COEFFICIENTS_C99_H__ */
